{
  "type": "object",
  "required": ["sections"],
  "additionalProperties": false,
  "properties": {
    "translations": {
      "title": "Translations",
      "type": "object",
      "description": "Multi-language translation resources",
      "additionalProperties": true
    },
    "users": {
      "title": "User Directory",
      "type": "array",
      "description": "Central user, role, and group definitions",
      "items": {
        "type": "object",
        "properties": {
          "username": { "type": "string" },
          "roles": { "type": "array", "items": { "type": "string" } },
          "groups": { "type": "array", "items": { "type": "string" } }
        }
      }
    },
    "audit": {
      "title": "Audit Trail",
      "type": "object",
      "description": "Track config changes",
      "properties": {
        "lastEdited": { "type": "string", "format": "date-time" },
        "lastEditor": { "type": "string" },
        "history": {
          "type": "array",
          "items": { "type": "object" }
        }
      }
    },
    "pages": {
      "title": "Page List",
      "type": "array",
      "description": "List of additional config files to load as extra pages",
      "items": {
        "title": "Page",
        "type": "object",
        "required": ["name", "path"],
        "additionalProperties": false,
        "properties": {
          "name": { "type": "string", "description": "Unique page identifier" },
          "path": { "type": "string", "description": "File name or path" },
          "displayData": { "$ref": "#/definitions/displayData" },
          "meta": {
            "title": "Custom Metadata",
            "type": "object",
            "description": "Extensible metadata for page",
            "additionalProperties": true
          }
        }
      }
    },
    "pageInfo": {
      "type": "object",
      "required": ["title"],
      "additionalProperties": false,
      "properties": {
        "title": { "type": "string", "description": "App title" },
        "description": { "type": "string" },
        "navLinks": {
          "type": "array",
          "maxItems": 6,
          "items": { "$ref": "#/definitions/navLink" }
        },
        "footerText": { "type": "string" },
        "logo": { "type": "string", "pattern": "^(http|/)(.*?)" }
      }
    },
    "appConfig": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "startingView": { "type": "string", "enum": ["default", "minimal", "workspace"] },
        "defaultOpeningMethod": { "type": "string", "enum": ["newtab", "sametab", "parent", "top", "modal", "workspace", "clipboard"] },
        "statusCheck": { "type": "boolean" },
        "statusCheckInterval": { "type": "number" },
        "language": { "type": "string" },
        "theme": { "type": "string" },
        "backgroundImg": { "type": "string" },
        "faviconApi": { "type": "string" },
        "defaultIcon": { "type": "string" },
        "layout": { "type": "string" },
        "iconSize": { "type": "string" },
        "colCount": { "type": "number" },
        "routingMode": { "type": "string" },
        "workspaceLandingUrl": { "type": "string" },
        "enableMultiTasking": { "type": "boolean" },
        "widgetsAlwaysUseProxy": { "type": "boolean" },
        "webSearch": { "$ref": "#/definitions/webSearch" },
        "enableFontAwesome": { "type": "boolean" },
        "enableMaterialDesignIcons": { "type": "boolean" },
        "fontAwesomeKey": { "type": "string", "pattern": "^[a-z0-9]{10}$" },
        "cssThemes": { "type": "array", "items": { "type": "string" } },
        "customColors": { "type": "object" },
        "externalStyleSheet": { "type": "array", "items": { "type": "string" } },
        "customCss": { "type": "string" },
        "hideComponents": { "$ref": "#/definitions/hideComponents" },
        "auth": { "$ref": "#/definitions/authConfig" },
        "showSplashScreen": { "type": "boolean" },
        "preventWriteToDisk": { "type": "boolean" },
        "preventLocalSave": { "type": "boolean" },
        "disableConfiguration": { "type": "boolean" },
        "disableConfigurationForNonAdmin": { "type": "boolean" },
        "allowConfigEdit": { "type": "boolean" },
        "enableServiceWorker": { "type": "boolean" },
        "disableContextMenu": { "type": "boolean" },
        "disableUpdateChecks": { "type": "boolean" },
        "disableSmartSort": { "type": "boolean" },
        "enableErrorReporting": { "type": "boolean" },
        "sentryDsn": { "type": "string" }
      }
    },
    "sections": {
      "type": "array",
      "items": {
        "title": "Section",
        "type": "object",
        "required": ["name"],
        "additionalProperties": false,
        "properties": {
          "name": { "type": "string" },
          "icon": { "type": "string" },
          "displayData": { "$ref": "#/definitions/displayData" },
          "items": {
            "type": "array",
            "items": { "$ref": "#/definitions/item" }
          },
          "widgets": {
            "type": "array",
            "items": { "$ref": "#/definitions/widget" }
          },
          "filters": {
            "title": "Filters",
            "type": "object",
            "description": "Dynamic filters for section items",
            "additionalProperties": true
          },
          "meta": {
            "title": "Custom Metadata",
            "type": "object",
            "description": "Extensible metadata for section",
            "additionalProperties": true
          },
          "filteredItems": {
            "title": "Filtered Items - DEPRECATED",
            "type": "array",
            "description": "Deprecated: do not use!"
          }
        }
      }
    }
  },
  "definitions": {
    "displayData": {
      "type": "object",
      "properties": {
        "sortBy": { "type": "string", "enum": ["default", "most-used", "last-used", "alphabetical", "reverse-alphabetical", "random"] },
        "collapsed": { "type": "boolean" },
        "cutToHeight": { "type": "boolean" },
        "color": { "type": "string", "pattern": "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$|^[a-zA-Z]+$" },
        "customStyles": { "type": "string" },
        "itemSize": { "type": "string", "enum": ["small", "medium", "large"] },
        "rows": { "type": "number" },
        "cols": { "type": "number" },
        "sectionLayout": { "type": "string", "enum": ["grid", "auto"] },
        "itemCountX": { "type": "number" },
        "itemCountY": { "type": "number" },
        "hideForUsers": { "type": "array", "items": { "type": "string" } },
        "showForUsers": { "type": "array", "items": { "type": "string" } },
        "hideForGuests": { "type": "boolean" },
        "showForKeycloakUsers": {
          "type": "object",
          "properties": {
            "groups": { "type": "array", "items": { "type": "string" } },
            "roles": { "type": "array", "items": { "type": "string" } }
          }
        },
        "hideForKeycloakUsers": {
          "type": "object",
          "properties": {
            "groups": { "type": "array", "items": { "type": "string" } },
            "roles": { "type": "array", "items": { "type": "string" } }
          }
        }
      }
    },
    "navLink": {
      "type": "object",
      "required": ["title", "path"],
      "properties": {
        "title": { "type": "string" },
        "path": { "type": "string" },
        "target": { "type": "string", "enum": ["newtab", "sametab", "parent", "top"], "default": "newtab" }
      }
    },
    "webSearch": {
      "type": "object",
      "properties": {
        "disableWebSearch": { "type": "boolean" },
        "searchEngine": { "type": "string" },
        "customSearchEngine": { "type": "string" },
        "openingMethod": { "type": "string", "enum": ["newtab", "sametab", "modal", "workspace"] },
        "searchBangs": { "type": "object", "additionalProperties": true }
      }
    },
    "hideComponents": {
      "type": "object",
      "properties": {
        "hideHeading": { "type": "boolean" },
        "hideNav": { "type": "boolean" },
        "hideSearch": { "type": "boolean" },
        "hideSettings": { "type": "boolean" },
        "hideFooter": { "type": "boolean" }
      }
    },
    "authConfig": {
      "type": "object",
      "properties": {
        "enableGuestAccess": { "type": "boolean" },
        "users": { "type": "array", "items": { "type": "object" } },
        "enableOidc": { "type": "boolean" },
        "oidc": { "type": "object" },
        "enableHeaderAuth": { "type": "boolean" },
        "headerAuth": { "type": "object" },
        "enableKeycloak": { "type": "boolean" },
        "keycloak": { "type": "object" }
      }
    },
    "item": {
      "type": "object",
      "required": ["title"],
      "properties": {
        "title": { "type": "string" },
        "description": { "type": "string" },
        "icon": { "type": "string" },
        "url": { 
          "type": "string", 
          "pattern": "^(https?://[^\\s/$.?#].[^\\s]*|/[^\\s]*|[a-zA-Z0-9.-]+://[^\\s]+)$"
        },
        "displayData": { "$ref": "#/definitions/displayData" },
        "target": { "type": "string", "enum": ["newtab", "sametab", "parent", "top", "modal", "workspace", "clipboard"] },
        "hotkey": { "type": "number", "minimum": 0, "maximum": 9 },
        "rel": { "type": "string" },
        "tags": { "type": "array", "maxItems": 12, "items": { "type": "string" } },
        "provider": { "type": "string" },
        "statusCheck": { "type": "boolean" },
        "statusCheckUrl": { "type": "string" },
        "statusCheckHeaders": { "type": "object" },
        "statusCheckAllowInsecure": { "type": "boolean" },
        "statusCheckAcceptCodes": { "type": "string" },
        "statusCheckMaxRedirects": { "type": "number" },
        "color": { "type": "string", "pattern": "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$|^[a-zA-Z]+$" },
        "id": { "type": "string", "pattern": "^[a-zA-Z0-9-_]+$" },
        "subItems": { "type": "array", "items": { "type": "object" } },
        "ariaLabel": { "type": "string", "description": "Accessibility label" },
        "className": { "type": "string", "description": "Custom CSS class name(s)" },
        "meta": {
          "title": "Custom Metadata",
          "type": "object",
          "description": "Extensible metadata for item",
          "additionalProperties": true
        }
      }
    },
    "widget": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": { "type": "string" },
        "updateInterval": { "type": "number" },
        "timeout": { "type": "number" },
        "useProxy": { "type": "boolean" },
        "options": { "type": "object" },
        "dependencies": {
          "title": "Dependencies",
          "type": "array",
          "items": { "type": "string" }
        },
        "events": {
          "title": "Custom Events",
          "type": "array",
          "items": { "type": "string" }
        }
      }
    }
  }
}
